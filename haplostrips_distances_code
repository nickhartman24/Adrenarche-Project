#DESCRIPTION OF WHAT I'M DOING HERE. did this in a mac terminal, but in a conda environment. used bash throughout. also include that it creates multiple different types of outputs, and link to og haplostrips. 
#WHAT THIS REQUIRES BEFORE STARTING. THINK ABOUT: INSTALLING HAPLOSTRIPS, CONDA ENVIRONEMT, ETC. SAMPLES_HAPLO FILE AND IT'S LAYOUT  

#conduct haplostrips on gene CYB5A. Split into 4 groups because the figure creator aspect of Haplostrips is limited to a certain amount of populations allowed. 
#using the positions from UCSC genome browser, coding region only, no UTRs included. Nea (Vindija Neanderthal) must be included each round as the reference.

python haplostrips.py -v /pl/active/villanea_lab/data/modern_data/1000_genomes/20130502/ALL.chr18.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz -v /pl/active/villanea_lab/data/archaic_data/vindija_VCF/ftp.eva.mpg.de/neandertal/Vindija/VCF/Vindija33.19/chr18_mq25_mapab100.vcf.gz -P samples_haplo -i 18:71920819-71959110 -p Nea,CEU,TSI,GBR,GIH,PJL,BEB -c 0.001 -a -t -o cyb5a_first_group

python haplostrips.py -v /pl/active/villanea_lab/data/modern_data/1000_genomes/20130502/ALL.chr18.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz -v /pl/active/villanea_lab/data/archaic_data/vindija_VCF/ftp.eva.mpg.de/neandertal/Vindija/VCF/Vindija33.19/chr18_mq25_mapab100.vcf.gz -P samples_haplo -i 18:71920819-71959110 -p Nea,IBS,ITU,STU,FIN,PUR,CLM -c 0.001 -a -t -o cyb5a_second_group

python haplostrips.py -v /pl/active/villanea_lab/data/modern_data/1000_genomes/20130502/ALL.chr18.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz -v /pl/active/villanea_lab/data/archaic_data/vindija_VCF/ftp.eva.mpg.de/neandertal/Vindija/VCF/Vindija33.19/chr18_mq25_mapab100.vcf.gz -P samples_haplo -i 18:71920819-71959110 -p Nea,MXL,ASW,PEL,CDX,KHV,ACB,LWK -c 0.001 -a -t -o cyb5a_third_group

python haplostrips.py -v /pl/active/villanea_lab/data/modern_data/1000_genomes/20130502/ALL.chr18.phase3_shapeit2_mvncall_integrated_v5a.20130502.genotypes.vcf.gz -v /pl/active/villanea_lab/data/archaic_data/vindija_VCF/ftp.eva.mpg.de/neandertal/Vindija/VCF/Vindija33.19/chr18_mq25_mapab100.vcf.gz -P samples_haplo -i 18:71920819-71959110 -p Nea,CHB,CHS,GWD,JPT,MSL,YRI,ESN -c 0.001 -a -t -o cyb5a_fourth_group

#combine the four group files into one. 
head -n 1 $(ls cyb5a*group.distances_tab | head -n 1) > cyb5a_merged.distances_tab
tail -n +2 -q cyb5a*group.distances_tab >> cyb5a_merged.distances_tab

#Sort by the third column, which is distance, while preserving the header.  
(head -n 1 cyb5a_merged.distances_tab && tail -n +2 cyb5a_merged.distances_tab | sort -k3,3n) > cyb5a_sorted.distances_tab

